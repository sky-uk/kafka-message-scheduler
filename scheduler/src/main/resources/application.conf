scheduler {
  reader {
    schedule-topic = ${?SCHEDULE_TOPIC}
    kafka-brokers = "localhost:9092"
    kafka-brokers = ${?KAFKA_BROKERS}
  }
}

akka {
  loggers = ["akka.event.slf4j.Slf4jLogger"]
  loglevel = "WARNING"
  loglevel = ${?KMS_LOGGING_LEVEL}
  logging-filter = "akka.event.slf4j.Slf4jLoggingFilter"

  kafka {
    consumer {
      poll-interval = 50ms
      poll-timeout = 50ms
      stop-timeout = 30s
      close-timeout = 20s
      commit-timeout = 15s
      wakeup-timeout = 3s
      max-wakeups = 10
      use-dispatcher = "akka.kafka.default-dispatcher"

      kafka-clients {
        auto.offset.reset = "earliest"
        group.id = "com.sky.kafka.scheduler"
        bootstrap.servers = ${scheduler.kafka-brokers}

        security.protocol = PLAINTEXT
        security.protocol = ${?SECURITY_PROTOCOL}
        ssl {
          keystore {
            location = ${?KEYSTORE_LOCATION}
            password = ${?KEYSTORE_PASSWORD}
          }
          truststore {
            location = ${?TRUSTSTORE_LOCATION}
            password = ${?TRUSTSTORE_PASSWORD}
          }
        }

      }
    }

    producer {
      parallelism = 100
      close-timeout = 60s
      use-dispatcher = "akka.kafka.default-dispatcher"

      kafka-clients {
        bootstrap.servers = ${scheduler.kafka-brokers}

        security.protocol = PLAINTEXT
        security.protocol = ${?SECURITY_PROTOCOL}
        ssl {
          keystore {
            location = ${?KEYSTORE_LOCATION}
            password = ${?KEYSTORE_PASSWORD}
          }
          truststore {
            location = ${?TRUSTSTORE_LOCATION}
            password = ${?TRUSTSTORE_PASSWORD}
          }
        }

      }
    }
  }
}

kamon {
  util.filters {
    "kms-actors" {
      includes = ["kafka-message-scheduler/**"]
    }
  }

  akka.actor-groups = ["kms-actors"]
  reporters = ["kamon.prometheus.PrometheusReporter"]
  prometheus {
    buckets {
      default-buckets = ${?PROMETHEUS_DEFAULT_BUCKETS}
      time-buckets = ${?PROMETHEUS_TIME_BUCKETS}
      information-buckets = ${?PROMETHEUS_INFORMATION_BUCKETS}
    }

    embedded-server {
      hostname = 0.0.0.0
      port = 9095
      port = ${?PROMETHEUS_SCRAPING_ENDPOINT_PORT}
    }
  }
  //Bare minimum configuration required for JMX collector
  jmx-collector {
    mbeans = [],
    initial-delay = 5 second,
    value-check-interval = 5 seconds
  }

  system-metrics.host.enabled = false
}